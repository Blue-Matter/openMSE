---
date: "2021-02-26T15:18:01+06:00"
title: Surplus production model
weight: 3
---



<div id="dynamics-equations" class="section level3">
<h3>Dynamics equations</h3>
<p>The surplus production model uses the Fletcher (1978) formulation. The biomass <span class="math inline">\(B_t\)</span> in year <span class="math inline">\(t\)</span> is
<span class="math display">\[B_t = B_{t-1} + P_{t-1} - C_{t-1},\]</span>
where <span class="math inline">\(C_t\)</span> is the observed catch and <span class="math inline">\(P_t\)</span> is the surplus production given by:
<span class="math display">\[P_t = \gamma \times MSY \times \left(\dfrac{B_t}{K}-\left[\dfrac{B_t}{K}\right]^n\right), \]</span>
where <span class="math inline">\(K\)</span> is the carrying capacity, <span class="math inline">\(MSY\)</span> is the maximum sustainable yield, and <span class="math inline">\(n\)</span> is the parameter that controls shape of the production curve, and
<span class="math inline">\(\gamma\)</span> is
<span class="math display">\[\gamma = \dfrac{1}{n-1}n^{n/(n-1)}.\]</span></p>
<p>The fishing mortality <span class="math inline">\(F_t\)</span> is conditioned on the observed catch <span class="math inline">\(C_t\)</span>. If fishing occurs as a pulse fishery, then
<span class="math display">\[\hat{F}_t = \dfrac{C_t}{\hat{B}_t},\]</span>
where <span class="math inline">\(F_t\)</span> is effectively an exploitation rate.</p>
</div>
<div id="continuous-surplus-production" class="section level3">
<h3>Continuous surplus production</h3>
<p>Smaller time steps are used in the model to approximate continuous production and fishing. With the biomass at the start of the year, the model iteratively solves for the year-specific fishing mortality rate that produces the observed annual catch over sub-annual time steps.</p>
<p>For each seasonal time step <span class="math inline">\(t&#39;\)</span> within year,</p>
<p><span class="math display">\[
\begin{align}
P_{t&#39;} &amp;= \Delta \times \gamma \times MSY \times \left(\dfrac{B_{t&#39;}}{K}-\left[\dfrac{B_{t&#39;}}{K}\right]^n\right)\\
C_{t&#39;} &amp;= \Delta \times F_t \times B_{t&#39;}\\
B_{t&#39;+1} &amp;= B_{t&#39;} + P_{t&#39;} - C_{t&#39;}\\
C_t &amp;= \sum_{t&#39;} C_{t&#39;}
\end{align}
\]</span></p>
<p>By default, four sub-annual time steps <span class="math inline">\(\Delta = 0.25\)</span> with <span class="math inline">\(t&#39;=1,2,3,4\)</span> are used to solve for <span class="math inline">\(F_t\)</span>.</p>
</div>
<div id="estimated-and-derived-parameters" class="section level3">
<h3>Estimated and derived parameters</h3>
<p>The model is configured with <span class="math inline">\(F_{MSY}\)</span> and <span class="math inline">\(MSY\)</span> as leading parameters to be estimated.</p>
<p>The biomass <span class="math inline">\(B_{MSY}\)</span> at <span class="math inline">\(MSY\)</span> is
<span class="math display">\[B_{MSY} = \dfrac{MSY}{F_{MSY}},\]</span>
the carrying capacity <span class="math inline">\(K\)</span> is
<span class="math display">\[K = n^{1/(n-1)} \times B_{MSY} ,\]</span>
and the intrinsic rate of population increase <span class="math inline">\(r\)</span> is
<span class="math display">\[ r = n \times F_{MSY}.\]</span></p>
<div id="schaefer-model" class="section level4">
<h4>Schaefer model</h4>
<p>The production parameter <span class="math inline">\(n\)</span> is typically fixed, and the Schaefer model with a symmetric productive curve (<span class="math inline">\(B_{MSY}/K = 0.5\)</span>) is produced when <span class="math inline">\(n = 2\)</span> (default).</p>
</div>
<div id="fox-model-sp_fox" class="section level4">
<h4>Fox model (SP_Fox)</h4>
<p>The Fox model is the limiting case of the Fletcher parameterization as <span class="math inline">\(n \rightarrow 1\)</span>, where</p>
<p><span class="math display">\[K = e \times B_{MSY}\]</span>
<span class="math display">\[r = F_{MSY}\]</span>
<span class="math display">\[P_t = -e \times MSY \times \dfrac{B_t}{K} \times \log\left(\dfrac{B_t}{K}\right) \]</span>
where <span class="math inline">\(e\)</span> is Euler’s number.</p>
</div>
</div>
<div id="state-space-version-sp_ss" class="section level3">
<h3>State-space version (SP_SS)</h3>
<p>In the state-state version, annual biomass deviates are estimated as random effects. Similar to Meyer and Millar (1999), the biomass <span class="math inline">\(B_t\)</span> in year <span class="math inline">\(t\)</span> is
<span class="math display">\[B_t = (B_{t-1} + P_{t-1} - C_{t-1})\exp(\delta_t - 0.5 \tau^2),\]</span>
where <span class="math inline">\(\delta_t \sim N(0, \tau^2)\)</span> are biomass deviations in lognormal space and <span class="math inline">\(\tau\)</span> is the standard deviation of the biomass deviations.</p>
</div>
<div id="likelihood" class="section level3">
<h3>Likelihood</h3>
<p>By conditioning the model on observed catch, the model is fitted to the indices of abundance <span class="math inline">\(I_{s,t}\)</span>. The likelihood of the observed indices, using assuming a lognormal distribution, is
<span class="math display">\[L^I = \sum_s \lambda_s \sum_t \left(-\log(\sigma_{s,t}) - 0.5\left[\dfrac{\log(I_{s,t}) - \log(\hat{q}_s \hat{B}_t)}{\sigma_{s,t}}\right]^2\right)\]</span>
where <span class="math inline">\(lamba_s\)</span> is the weighting coefficient of index <span class="math inline">\(s\)</span>, <span class="math inline">\(q_s\)</span> is the cathabilitiy coefficient, and the circumflex denotes an estimate.</p>
<p>Log-biomass deviations <span class="math inline">\(\hat{\delta}_t\)</span> are typically estimated as penalized parameters towards the likelihood, with the penalty:
<span class="math display">\[L^{\delta} = \sum_t \left(-\log(\tau) - 0.5\left[\dfrac{\delta_t}{\tau}\right]^2\right).\]</span></p>
<div id="prior-for-msy" class="section level4">
<h4>Prior for MSY</h4>
<p>A lognormal prior (a penalty to the likelihood) can be provided to the model:</p>
<p><span class="math display">\[L^{\textrm{MSY}} = - 0.5\left(\dfrac{\log(\widehat{\textrm{MSY}}) - \log(\mu_{\textrm{MSY}})}{\sigma_{\textrm{MSY}}}\right)^2\]</span></p>
</div>
<div id="prior-for-r" class="section level4">
<h4>Prior for r</h4>
<p>A lognormal prior for the <span class="math inline">\(r\)</span> can be provided to the model:</p>
<p><span class="math display">\[L^r = - 0.5\left(\dfrac{\log(\hat{r}) - \log(\mu_r)}{\sigma_r}\right)^2,\]</span>
Users can explicitly specify <span class="math inline">\(\log(\mu_r)\)</span> and <span class="math inline">\(\sigma_r\)</span>.</p>
<p>Alternatively, the Euler-Lotka method can be used to generate the prior for the intrinsic rate of increase, by sampling natural mortality <span class="math inline">\(M\)</span> and steepness <span class="math inline">\(h\)</span> from a distribution. Natural mortality is modelled to be age-invariant and is sampled from a lognormal distribution. With either a Beverton-Holt or Ricker stock-recruit relationship, steepness is sampled from a transformed beta or transformed lognormal distribution, respectively. From these samples, <span class="math inline">\(\log(\mu_r)\)</span> and <span class="math inline">\(\sigma_r\)</span> are calculated.</p>
<p>For each pair of sampled M and h values, the corresponding value of <span class="math inline">\(r\)</span> is obtained by solving a modified Euler-Lotka equation:
<span class="math display">\[\alpha \sum_a l_a f_a \exp(-r \times a) = 1.\]</span></p>
<p>Equation 16 is modified to include the <span class="math inline">\(\alpha\)</span> term from the stock-recruit relationship (Stanley et al. 2009). In this way, the recruits-per-spawner at low stock sizes, i.e., as spawning biomass approaches zero, is considered for calculating <span class="math inline">\(r\)</span>.</p>
<p>The numbers-per-recruit at age <span class="math inline">\(a\)</span> is
<span class="math display">\[
l_a =
\begin{cases}
      1 &amp; a = 1\\
      l_{a-1} \exp(-M_{a-1}) &amp; a = 2, \ldots, A-1\\
      \dfrac{l_{a-1} \exp(-M_{a-1})}{1 - \exp(-M_a)} &amp; a = A \\
\end{cases}.
\]</span></p>
<p>Fecundity at age <span class="math inline">\(f_a\)</span> is
<span class="math display">\[m_a = w_a\left[1 + \exp\left(-\log(19) \dfrac{a - \tilde{a}_{50}}{\tilde{a}_{95} - \tilde{a}_{50}}\right)\right]^{-1}, \]</span>
where <span class="math inline">\(\tilde{a}_{50}\)</span> and <span class="math inline">\(\tilde{a}_{95}\)</span> are the ages of 50% and 95% maturity, respectively.</p>
<p>Weight-at-age <span class="math inline">\(w_a\)</span> is
<span class="math display">\[w_a = W_{\infty}(1 - \exp[K\{a-a_0\}])^b.\]</span></p>
<p>The recruits per spawner at the origin of the stock-recruit relationship <span class="math inline">\(\alpha\)</span> is
<span class="math display">\[\alpha = \dfrac{4h}{(1-h)\phi_0}, \]</span>
or
<span class="math display">\[\alpha = \dfrac{(5h)^{1.25}}{\phi_0},\]</span>
for a Beverton-Holt and Ricker stock-recruit relationship, respectively. Unfished recruits-per-spawner <span class="math inline">\(\phi_0\)</span>
is
<span class="math display">\[\phi_0 = \sum_a l_a f_a.\]</span></p>
</div>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<p>Fletcher, R.I. 1978. On the restructuring of the Pella-Tomlinson system. Fishery Bulletin 76:515-521.</p>
<p>Meyer, R., and Millar, R.B. 1999. BUGS in Bayesian stock assessments. Canadian Journal of Fisheries and Aquatic Science 56:1078-1086.</p>
<p>Stanley, R.D., M. McAllister, P. Starr and N. Olsen. 2009. Stock assessment for bocaccio (<em>Sebastes
paucispinis</em>) in British Columbia waters. DFO Can. Sci. Advis. Sec. Res. Doc. 2009/055.
xiv + 200 p. </p>
</div>
