---
date: "2021-01-21T11:35:01+06:00"
title: Fleet selectivity
weight: 1
---



<p>The general function call for <code>RCM</code> is:</p>
<pre class="r"><code>output &lt;- RCM(OM, RCMdata, ...)</code></pre>
<p>where the <code>output</code> is of class <a href="https://samtool.openmse.com/reference/RCModel-class.html">RCModel</a>, <code>OM</code> is a class <a href="https://msetool.openmse.com/reference/OM-class.html">OM</a> object, <code>RCMdata</code> is an <a href="https://samtool.openmse.com/reference/RCMdata-class.html">RCMdata</a> object, and <code>...</code> include selectivity arguments explained in this article.</p>
<div id="time-blocks-for-selectivity" class="section level3">
<h3>Time blocks for selectivity</h3>
<p>Fleet selectivity can be vary in time using time blocks. Let’s say we have 2 fleets, a 10-year time series, and the first fleet selectivity changes in year 6. Thus, we have 3 selectivity blocks, a.k.a. dummy fleets each with their own selectivity. For each ‘true’ fleet and year in the model, we will assign the selectivity to one of the three dummy fleets. To do so, we create a 10 by 2 integer matrix for <code>RCMdata@sel_block</code>:</p>
<pre class="r"><code>RCMdata@sel_block</code></pre>
<pre><code>##       [,1] [,2]
##  [1,]    1    3
##  [2,]    1    3
##  [3,]    1    3
##  [4,]    1    3
##  [5,]    1    3
##  [6,]    2    3
##  [7,]    2    3
##  [8,]    2    3
##  [9,]    2    3
## [10,]    2    3</code></pre>
<p>Thus, for the first fleet (first column), we assign the selectivity of dummy fleet #1 to years 1-5 and that of dummy fleet #2 to years 6-10. The second fleet is assigned to dummy fleet #3 for all years.</p>
<p>By default, a unique dummy fleet is assigned to each fleet, indicating no time-varying selectivity, and the above code chunk is not needed, i.e., there is no distinction between dummy fleets and the true fleets.</p>
</div>
<div id="selectivity-of-each-dummy-fleet" class="section level3">
<h3>Selectivity of each dummy fleet</h3>
<p>We specify the selectivity as a character vector with each entry corresponding to dummy fleet:</p>
<pre class="r"><code>selectivity &lt;- c(&quot;logistic&quot;, &quot;dome&quot;, &quot;free&quot;)</code></pre>
<p>Thus, the selectivity of the first dummy fleet is logistic, the second is dome, and the third is free, i.e., independent parameters for each age.</p>
<p>These functions are described <a href="../../tutorial-rcm-eq/1-selectivity">here</a>.</p>
</div>
<div id="starting-values-of-selectivity-parameters" class="section level3">
<h3>Starting values of selectivity parameters</h3>
<p>For logistic and dome selectivity, the default behavior is to generate starting values from <code>OM@LFS</code>, <code>OM@L5</code>, and <code>OM@Vmaxlen</code>. Custom start values are needed when selectivity uses free parameters.</p>
<p>Custom starting values are passed to the model with the <code>start</code> list with a named entry for the <code>vul_par</code> matrix (the terms selectivity and vulnerability are used interchangeably). If only logistic or dome options are used, then <code>vul_par</code> is a matrix of 3 rows (corresponding to LFS, L5, and Vmaxlen) and <code>nsel_block</code> (3) columns:</p>
<pre class="r"><code>selectivity &lt;- c(&quot;logistic&quot;, &quot;dome&quot;, &quot;dome&quot;)
vul_par</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]   55 55.0 20.0
## [2,]   30 30.0 19.0
## [3,]    1  0.5  0.9</code></pre>
<p>Note that <code>Vmaxlen</code> is ultimately not used when the selectivity is logistic and the value in the third row, first column is merely an unused placeholder. If <code>vul_par</code> is provided, another step is needed to turn off this parameter (see next subsection).</p>
<p>If we have selectivity as free parameters (independent parameters for each age), <code>vul_par</code> has <code>OM@maxage + 1</code> rows with each row giving the selectivity value to the corresponding age (first row = age-0, etc.):</p>
<pre class="r"><code>OM@maxage &lt;- 5
selectivity &lt;- c(&quot;logistic&quot;, &quot;dome&quot;, &quot;free&quot;)
vul_par</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]   55 45.0  0.1
## [2,]   30 30.0  0.3
## [3,]    1  0.5  0.7
## [4,]   NA   NA  1.0
## [5,]   NA   NA  1.0
## [6,]   NA   NA  1.0</code></pre>
<p>Rows 4 to maxage+1 for logistic and dome selectivity (columns 1 and 2) are unused placeholders.</p>
</div>
<div id="fixing-and-sharing-parameters" class="section level3">
<h3>Fixing and sharing parameters</h3>
<p>Selectivity parameters may be fixed or shared. In TMB, this is accomplished by the <code>map</code> argument, which can be provided in <code>RCM</code> via the <code>map</code> list with named entry for <code>vul_par</code>. <code>map$vul_par</code> tells TMB what to do to the parameter of the corresponding row and column in <code>vul_par</code>. Shared parameters are assigned a unique integer amongst themselves while fixed or unused parameters are assigned <code>NA</code>. Let’s look at the first <code>vul_par</code> example again:</p>
<pre class="r"><code>selectivity &lt;- c(&quot;logistic&quot;, &quot;dome&quot;, &quot;dome&quot;)
vul_par</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]   55 55.0 20.0
## [2,]   30 30.0 19.0
## [3,]    1  0.5  0.9</code></pre>
<p>We want:</p>
<ul>
<li>LFS and L5 for the first two dummy fleets to be identical</li>
<li>Vmaxlen in the third dummy fleet to be fixed</li>
<li>The parameter reserved for Vmaxlen for the first dummy fleet to be turned off since it’s merely a placeholder</li>
<li>All other parameters are estimated unique parameters</li>
</ul>
<p>The matrix <code>map_vul_par</code> that accomplishes these tasks will look like this:</p>
<pre class="r"><code>map_vul_par</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    1    4
## [2,]    2    2    5
## [3,]   NA    3   NA</code></pre>
<p>For the second <code>vul_par</code> example, we want:</p>
<ul>
<li>Selectivity of dummy fleet #3 to be estimated only for ages 0 and 1</li>
<li>The parameter reserved for Vmaxlen for the first block to be turned off since it’s a placeholder</li>
<li>Rows 4-6 for the first two blocks to be turned off (they’re placeholders and undefined in the model)</li>
</ul>
<p>The matrix <code>map_vul_par</code> that accomplishes these tasks will look like this:</p>
<pre class="r"><code>selectivity &lt;- c(&quot;logistic&quot;, &quot;dome&quot;, &quot;free&quot;)
map_vul_par</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    6
## [2,]    2    4    7
## [3,]   NA    5   NA
## [4,]   NA   NA   NA
## [5,]   NA   NA   NA
## [6,]   NA   NA   NA</code></pre>
<p>Finally the function call looks like this:</p>
<pre class="r"><code>output &lt;- RCM(OM, RCMdata, selectivity = selectivity, 
              start = list(vul_par = vul_par), 
              map = list(vul_par = map_vul_par), 
              ...)</code></pre>
</div>
